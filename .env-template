########################################
# Discord Bot Configuration
########################################

# Discord bot token (REQUIRED)
# From: Discord Developer Portal → Bot → Token
BOT_TOKEN="bot_token"

# Bot environment (development | production)
# Toggles testing/dev commands on/off
BOT_ENV=production

# Discord application (client) ID (REQUIRED)
# From: Discord Developer Portal → General Information → Application ID
CLIENT_ID="client_id"

# Discord guild (server) ID for slash command registration (REQUIRED)
# Enable Developer Mode in Discord → right-click server → Copy ID
GUILD_ID="guild_id"

# Required: SQLite DB path and file
# DB_PATH=./data/liquidity-sentinel.sqlite ## prod
DB_PATH=./data/liquidity-sentinel-dev.sqlite ## dev

# Ephemerals off for testing
# 0 = Production (ephemerals where needed)
# 1 = Testing (all ephemerals off)
EPHEMERALS_OFF=0


########################################
# RPC
########################################

SCAN_OVERLAP_BLOCKS=50
# FLR Network - Scan
FLR_MAINNET_SCAN="https://rpc.ankr.com/flare"
FLR_MAINNET_SCAN_BLOCKS=1000 # rpc.ankr.com supports 1000
FLR_MAINNET_SCAN_PAUSE_MS=250
# FLR Network - Monitor / Heartbeat
FLR_MAINNET="https://flare-api.flare.network/ext/C/rpc"
# XDC Network - Scan
XDC_MAINNET_SCAN="https://rpc.primenumbers.xyz/"
XDC_MAINNET_SCAN_BLOCKS=2000
XDC_MAINNET_SCAN_PAUSE_MS=250
# XDC Network - Monitor / Heartbeat
XDC_MAINNET="https://rpc.primenumbers.xyz/"


########################################
# Logging
########################################

# Logging verbosity:
# 0 = errors only
# 1 = warnings + errors
# 2 = info + warnings + errors
# 3 = debug + info + warnings + errors
DEBUG=2
SCAN_DEBUG=1
# Disable colors (CI, log files)
# NO_COLOR=1
# Force colors (Docker / piped output)
# FORCE_COLOR=1


########################################
# Scheduler / Cron / Example Jobs
########################################

# Recommended production: CRON_SCHED="*/15 0-2,4-23 * * *"
# Run every 15 minutes every hour of the day except 3 AM hour
# MINUTES HOUR DayOfMonth Month DayOfWeek
CRON_SCHED="*/10 0-2,4-23 * * *"
HEARTBEAT_CRON="0 3 * * *"         # 3 AM local time (America/Los_Angeles)
HEARTBEAT_TZ=America/Los_Angeles

# Snapshot staleness warning (minutes)
SNAPSHOT_STALE_WARN_MIN=20

########################################
# Firelight Vault Signal
########################################

# Firelight channel (single message will be edited in place)
FIRELIGHT_CHANNEL_ID="channel_id"

# Firelight poll cadence (minutes)
FIRELIGHT_POLL_MIN=10

# Firelight vault (FXRP)
FIRELIGHT_VAULT_ADDRESS="0x4C18Ff3C89632c3Dd62E796c0aFA5c07c4c1B2b3"

# TESTING
#CRON_SCHED='*/2 * * * *'            # Testing every X minutes
#HEARTBEAT_CRON="*/2 * * * *"        # Testing every X minutes


########################################
# CDP / LOANS LIQUIDATION/REDEMPTIONS
########################################

# Use POOL (on-chain) or ENV (manual override) for CDP price
CDP_PRICE_MODE=POOL
# Enosys V3 CDP/USD₮0 pool on Flare (Uniswap v3 style)
CDP_POOL_ADDR_FLR=0x975f0369d31f1dd79abf057ad369ae7d5b9f6fb4
# Fallback manual price if pool fetch fails
CDP_PRICE_USD=0.998
# threshold where redemptions become economically attractive:
CDP_REDEMPTION_TRIGGER=0.995

# Redemption IR tiers, in percentage points:
# diff = (your IR) - (GLOBAL_IR_PROTOCOL)
# Where to fetch global IR from
GLOBAL_IR_URL="https://flrfinance.github.io/api.liquity.org-fork/v2/flare.json"
GLOBAL_IR_BRANCHES="FXRP,WFLR"

REDEMP_BELOW_CRITICAL=-1.0      # <= -1.0pp → CRITICAL
REDEMP_ABOVE_MED=0.25           # (0, 0.25]pp → MEDIUM; else LOW

# Redemption tiers (debt-ahead fraction; higher = safer)
REDEMP_DEBT_AHEAD_LOW_PCT=0.70
REDEMP_DEBT_AHEAD_MED_PCT=0.40
REDEMP_DEBT_AHEAD_HIGH_PCT=0.20

# Liquidation buffer tiers (fractions)
LIQ_BUFFER_WARN=0.50   # <= buffer → MEDIUM
LIQ_BUFFER_HIGH=0.30   # <= buffer → HIGH
LIQ_BUFFER_CRIT=0.15   # <= buffer → CRITICAL
# > 50% → LOW


#############################################
# LP RANGE TIER THRESHOLDS
#############################################

# In-range: how close (fraction of full tick width) before upgrading risk.
# Example: 0.15 = MEDIUM when within 15% of an edge.
LP_EDGE_WARN_FRAC=0.15
# In-range: HIGH risk when extremely close to edge.
# Example: 0.05 = HIGH when within 5% of the band boundary.
LP_EDGE_HIGH_FRAC=0.05
# Out-of-range: how far outside the band you are (as fraction of width).
# Example: 0.5 = MEDIUM when within 0.5× width outside.
LP_OUT_WARN_FRAC=0.5
# Out-of-range: HIGH risk when 0.5–1.5× width outside.
# Anything beyond this becomes CRITICAL.
LP_OUT_HIGH_FRAC=1.5

#############################################
# LP DEX POSITION LINKS
#############################################
ENOSYS_LP_POSITION_URL_BASE="https://v3.dex.enosys.global/liquidity/position/"
XSWAP_LP_POSITION_URL_BASE="https://app.xspswap.finance/#/pools/"
SPARKDEX_LP_POSITION_URL_BASE="https://sparkdex.ai/pool"

#############################################
# LOAN POSITION LINKS
#############################################
ENOSYS_LOAN_TROVE_URL="https://loans.enosys.global/"


#############################################
# LOAN / LP ALERT MINIMUM TIERS
#############################################

# LP alert debounce (seconds)
LP_WORSENING_DEBOUNCE_SEC=300  # 5 minutes sustained worsening before alert
LP_IMPROVING_DEBOUNCE_SEC=600  # 10 minutes sustained improvement before alert
#LP_WORSENING_DEBOUNCE_SEC=1  # TESTING
#LP_IMPROVING_DEBOUNCE_SEC=2  # TESTING

# LOAN liquidation alert debouncing (seconds)
LOAN_LIQ_WORSENING_DEBOUNCE_SEC=240  # 4 minutes sustained worsening before alert
LOAN_LIQ_IMPROVING_DEBOUNCE_SEC=360  # 6 minutes sustained improvement before alert
#LOAN_LIQ_WORSENING_DEBOUNCE_SEC=1  # TESTING
#LOAN_LIQ_IMPROVING_DEBOUNCE_SEC=2  # TESTING

# LOAN redemption alert debouncing (seconds)
LOAN_REDEMP_WORSENING_DEBOUNCE_SEC=300  # 5 minutes sustained worsening before alert
LOAN_REDEMP_IMPROVING_DEBOUNCE_SEC=600  # 10 minutes sustained improvement before alert
#LOAN_REDEMP_WORSENING_DEBOUNCE_SEC=1  # TESTING
#LOAN_REDEMP_IMPROVING_DEBOUNCE_SEC=2  # TESTING
